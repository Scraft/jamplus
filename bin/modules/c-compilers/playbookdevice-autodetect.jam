BLACKBERRY_NATIVE_ENV_BATCH_FILE = ;

rule C.AutoDetect 
{
	if ! $(BBNDK)
	{
		return ;
	}
	
	BBNDK = $(BBNDK:J=" ") ;
	
	BLACKBERRY_NATIVE_ENV_BATCH_FILE = [ Glob $(BBNDK) : *bbndk-env.bat ] ;
	if ! $(BLACKBERRY_NATIVE_ENV_BATCH_FILE)
	{
		return ;
	}
	else
	{
		BLACKBERRY_NDK_DIR = $(BBNDK:TC\\) ;
		BLACKBERRY_NATIVE_ENV_BATCH_FILE = $(BLACKBERRY_NATIVE_ENV_BATCH_FILE:J=" ") ;
		BLACKBERRY_NATIVE_ENV_BATCH_FILE = $(BLACKBERRY_NATIVE_ENV_BATCH_FILE:TC\\) ;
	}
	
	COMPILER.$(PLATFORM) = playbookdevice ;

	# Use generic gcc module.
	UseModule c-compilers/c-gcc ;
	
	if $(PLATFORM) != *  &&  $(CONFIG) != * 
	{
		UseModule c-compilers/blackberry-gcc ;
	}
	
	return $(COMPILER.$(PLATFORM)) ;
}
